---
import { getCollection } from 'astro:content';

// Get featured projects from content collection
const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter(project => project.data.featured === true)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf());
---

{featuredProjects.length > 0 && (
  <section class="featured-projects py-20 md:py-[80px] border-t border-[#262626]">
    <div class="container-wide">
      <!-- Section Header -->
      <div class="flex items-center justify-between mb-8">
        <h2 class="section-title-premium" style="font-family: var(--font-display) !important;">ç²¾é€‰é¡¹ç›®</h2>
        <a
          href="/projects"
          class="text-[#A855F7] hover:underline transition-all"
        >
          æŸ¥çœ‹å…¨éƒ¨ â†’
        </a>
      </div>

      <!-- Projects Grid -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        {featuredProjects.map((project) => (
          <article
            class="project-card group rounded-2xl p-8 card-premium hover:-translate-y-1 transition-transform duration-300 relative"
            style="
              border-left: 3px solid;
              border-image: linear-gradient(to bottom, #06B6D4, #A855F7) 1;
            "
          >
            <a href={`/projects/${project.slug}`} class="block">
              {project.data.image ? (
                <div class="aspect-video rounded-lg overflow-hidden mb-4">
                  <img
                    src={project.data.image}
                    alt={project.data.title}
                    class="w-full h-full object-cover"
                  />
                </div>
              ) : (
                <div class="aspect-video rounded-lg bg-[var(--bg-secondary)] mb-4 flex items-center justify-center">
                  <span class="text-4xl">ðŸ“¦</span>
                </div>
              )}

              <h3 class="text-xl font-bold text-white mb-3 group-hover:text-[#06B6D4] transition-colors">
                {project.data.title}
              </h3>

              <p class="text-[#a3a3a3] text-base mb-4">
                {project.data.description}
              </p>

              <div class="project-tags flex flex-wrap gap-2 mb-6">
                {project.data.tech.map((tag) => (
                  <span
                    class="px-3 py-1 text-[12px] text-[#a3a3a3] rounded-lg"
                    style="border: 1px solid #333; background: transparent;"
                  >
                    {tag}
                  </span>
                ))}
              </div>
            </a>

            <div class="project-links flex gap-4">
              {project.data.github && (
                <a
                  href={project.data.github}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-[#06B6D4] hover:underline text-sm"
                  onclick="event.stopPropagation()"
                >
                  GitHub â†’
                </a>
              )}
              {project.data.demo && (
                <a
                  href={project.data.demo}
                  target="_blank"
                  rel="noopener noreferrer"
                  class="text-[#06B6D4] hover:underline text-sm"
                  onclick="event.stopPropagation()"
                >
                  Demo â†’
                </a>
              )}
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>
)}

---
const navItems = [
  { href: '/', label: 'ğŸ  é¦–é¡µ' },
  { href: '/blog', label: 'ğŸ“ åšå®¢' },
  { href: '/projects', label: 'ğŸ’¼ é¡¹ç›®' },
  { href: '/videos', label: 'ğŸ¥ è§†é¢‘' },
  { href: '/about', label: 'ğŸ‘¤ å…³äº' },
];
---

<!-- Mobile Menu Overlay -->
<div
  id="menu-overlay"
  class="fixed inset-0 bg-black/60 z-[999] opacity-0 pointer-events-none transition-opacity duration-300"
  onclick="window.closeMobileMenu()"
>
</div>

<!-- Mobile Menu Panel -->
<aside
  id="mobile-menu-panel"
  class="fixed top-0 right-0 w-[300px] h-screen z-[1000] transform translate-x-full transition-transform duration-300 ease-out"
  style="background: rgba(10, 10, 10, 0.95); backdrop-filter: blur(20px);"
>
  <div class="flex flex-col h-full">
    <!-- Close button -->
    <div class="flex justify-end p-5">
      <button
        type="button"
        onclick="window.closeMobileMenu()"
        class="p-2 text-white/70 hover:text-white hover:bg-white/10 rounded-lg transition-colors"
        aria-label="å…³é—­èœå•"
      >
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <!-- Navigation Links -->
    <nav class="flex-1 px-6">
      <ul class="space-y-1">
        {navItems.map((item) => (
          <li>
            <a
              href={item.href}
              class="block py-3 text-lg leading-[56px] text-white/80 hover:text-[#A855F7] transition-colors"
              onclick="window.closeMobileMenu()"
            >
              {item.label}
            </a>
          </li>
        ))}
      </ul>

      <!-- Divider -->
      <div class="my-6 border-t border-white/10"></div>

      <!-- Theme Toggle -->
      <button
        type="button"
        id="mobile-theme-toggle"
        class="flex items-center gap-3 py-3 text-lg text-white/80 hover:text-[#A855F7] transition-colors w-full"
        onclick="window.toggleMobileTheme()"
      >
        <span id="theme-icon">ğŸŒ™</span>
        <span id="theme-text">æ·±è‰²/æµ…è‰²</span>
      </button>
    </nav>

    <!-- Footer -->
    <div class="p-6 border-t border-white/10">
      <p class="text-sm text-white/40 text-center">
        Â© 2026 RollingTheRock
      </p>
    </div>
  </div>
</aside>

<script is:inline>
  // Global functions for menu control
  window.openMobileMenu = function() {
    const panel = document.getElementById('mobile-menu-panel');
    const overlay = document.getElementById('menu-overlay');

    if (panel && overlay) {
      panel.classList.remove('translate-x-full');
      overlay.classList.remove('opacity-0', 'pointer-events-none');
      document.body.style.overflow = 'hidden';
    }
  };

  window.closeMobileMenu = function() {
    const panel = document.getElementById('mobile-menu-panel');
    const overlay = document.getElementById('menu-overlay');

    if (panel && overlay) {
      panel.classList.add('translate-x-full');
      overlay.classList.add('opacity-0', 'pointer-events-none');
      document.body.style.overflow = '';
    }
  };

  // Theme toggle
  window.toggleMobileTheme = function() {
    const currentTheme = localStorage.getItem('theme') || 'system';
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const isDark = currentTheme === 'dark' || (currentTheme === 'system' && prefersDark);

    if (isDark) {
      localStorage.setItem('theme', 'light');
      document.documentElement.setAttribute('data-theme', 'light');
      updateThemeIcon(false);
    } else {
      localStorage.setItem('theme', 'dark');
      document.documentElement.setAttribute('data-theme', 'dark');
      updateThemeIcon(true);
    }
  };

  function updateThemeIcon(isDark) {
    const icon = document.getElementById('theme-icon');
    if (icon) {
      icon.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
    }
  }

  // Update icon on load
  (function() {
    const theme = localStorage.getItem('theme') || 'system';
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const isDark = theme === 'dark' || (theme === 'system' && prefersDark);
    updateThemeIcon(isDark);
  })();

  // Close on ESC key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') {
      window.closeMobileMenu();
    }
  });
</script>

---
import ImagePlaceholder from './ImagePlaceholder.astro';
import { formatDateFull } from '../utils/date';
import { getPlatformName, type VideoPlatform } from '../utils/platform';

interface Props {
  title: string;
  slug: string;
  date: Date;
  platform: VideoPlatform;
  thumbnail?: string;
}

const { title, slug, date, platform, thumbnail } = Astro.props;
---

<article class="group">
  <a href={`/videos/${slug}`} class="block">
    <!-- Thumbnail with Play Button -->
    <div class="relative aspect-video overflow-hidden rounded-xl bg-[var(--bg-secondary)] img-hover">
      {thumbnail ? (
        <img
          src={thumbnail}
          alt={title}
          class="w-full h-full object-cover"
        />
      ) : (
        <ImagePlaceholder alt={title} aspectRatio="16/9" class="w-full h-full" />
      )}

      <div class="absolute inset-0 flex items-center justify-center bg-black/20 group-hover:bg-black/30 transition-colors">
        <div class="w-16 h-16 rounded-full bg-white/90 flex items-center justify-center group-hover:scale-110 transition-transform">
          <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="currentColor" class="text-black ml-1">
            <polygon points="5 3 19 12 5 21 5 3"></polygon>
          </svg>
        </div>
      </div>

      <!-- Platform Badge -->
      <div class="absolute bottom-3 left-3 px-2 py-1 bg-black/70 text-white text-xs rounded">
        {getPlatformName(platform)}
      </div>
    </div>

    <div class="mt-4">
      <h2 class="text-lg font-semibold group-hover:text-[var(--text-secondary)] transition-colors line-clamp-2">
        {title}
      </h2>
      <p class="text-sm text-[var(--text-muted)] mt-1">
        {formatDateFull(date)}
      </p>
    </div>
  </a>
</article>
